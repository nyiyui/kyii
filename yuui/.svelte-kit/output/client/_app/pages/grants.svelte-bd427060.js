import{S as fe,i as ue,s as ce,e as k,t as D,c as E,a as C,h as I,d as m,b as R,g as L,J as d,j as H,E as le,_ as _e,w as F,x as K,y as z,q as O,o as G,B as Q,k as U,m as V,n as me,p as pe,a2 as we,K as qe,Y as Ie,v as Re,l as ge}from"../chunks/index-471c5598.js";import{a as ye,f as Ne,Y as Te}from"../chunks/api2-564f7f8d.js";import{L as Ce}from"../chunks/Loading-28866ca5.js";import{B as Be}from"../chunks/BoxError-e4fbeeb7.js";import{B as Oe}from"../chunks/Box-a27f9004.js";import{S as Se}from"../chunks/Scope-e19db83e.js";import{d as Ge}from"../chunks/store-669d404b.js";import"../chunks/index-0b2b7ad8.js";import"../chunks/singletons-d1fb5791.js";import"../chunks/Icon-b960e3f0.js";function Ae(o){let e,l=o[0].name+"",t,n,s,a,f=o[0].user_name+"",v,r;return{c(){e=k("a"),t=D(l),s=D(` by
`),a=k("a"),v=D(f),this.h()},l(u){e=E(u,"A",{href:!0});var i=C(e);t=I(i,l),i.forEach(m),s=I(u,` by
`),a=E(u,"A",{href:!0});var $=C(a);v=I($,f),$.forEach(m),this.h()},h(){R(e,"href",n="/oclient?oclid="+o[0].client_id),R(a,"href",r="/user?uid="+o[0].user_id)},m(u,i){L(u,e,i),d(e,t),L(u,s,i),L(u,a,i),d(a,v)},p(u,[i]){i&1&&l!==(l=u[0].name+"")&&H(t,l),i&1&&n!==(n="/oclient?oclid="+u[0].client_id)&&R(e,"href",n),i&1&&f!==(f=u[0].user_name+"")&&H(v,f),i&1&&r!==(r="/user?uid="+u[0].user_id)&&R(a,"href",r)},i:le,o:le,d(u){u&&m(e),u&&m(s),u&&m(a)}}}function Me(o,e,l){let{client:t}=e;return o.$$set=n=>{"client"in n&&l(0,t=n.client)},[t]}class Pe extends fe{constructor(e){super();ue(this,e,Me,Ae,ce,{client:0})}}function ve(o,e,l){const t=o.slice();return t[6]=e[l],t}function $e(o){let e,l;return{c(){e=k("span"),l=D("Revoked"),this.h()},l(t){e=E(t,"SPAN",{class:!0});var n=C(e);l=I(n,"Revoked"),n.forEach(m),this.h()},h(){R(e,"class","tag")},m(t,n){L(t,e,n),d(e,l)},d(t){t&&m(e)}}}function be(o){let e,l,t;return{c(){e=k("input"),this.h()},l(n){e=E(n,"INPUT",{class:!0,type:!0}),this.h()},h(){R(e,"class","delete"),R(e,"type","button"),e.value="Force revoke"},m(n,s){L(n,e,s),l||(t=_e(e,"click",o[4]),l=!0)},p:le,d(n){n&&m(e),l=!1,t()}}}function ke(o){let e,l,t;return l=new Se({props:{name:o[6]}}),{c(){e=k("li"),F(l.$$.fragment)},l(n){e=E(n,"LI",{});var s=C(e);K(l.$$.fragment,s),s.forEach(m)},m(n,s){L(n,e,s),z(l,e,null),t=!0},p(n,s){const a={};s&1&&(a.name=n[6]),l.$set(a)},i(n){t||(O(l.$$.fragment,n),t=!0)},o(n){G(l.$$.fragment,n),t=!1},d(n){n&&m(e),Q(l)}}}function Ue(o){let e,l=new Date(o[0].request.expires_at*1e3)+"",t,n,s,a=o[0].request.has_refresh_token?"yes":"no",f,v,r,u,i=o[0].request.token_type+"",$,p,w,y,M=JSON.stringify(o[0],null,2)+"",q;return{c(){e=D("Expires at: "),t=D(l),n=k("br"),s=D(`
			Has refresh token: `),f=D(a),v=k("br"),r=D(`
			Token type: `),u=k("code"),$=D(i),p=k("br"),w=U(),y=k("code"),q=D(M)},l(c){e=I(c,"Expires at: "),t=I(c,l),n=E(c,"BR",{}),s=I(c,`
			Has refresh token: `),f=I(c,a),v=E(c,"BR",{}),r=I(c,`
			Token type: `),u=E(c,"CODE",{});var h=C(u);$=I(h,i),h.forEach(m),p=E(c,"BR",{}),w=V(c),y=E(c,"CODE",{});var W=C(y);q=I(W,M),W.forEach(m)},m(c,h){L(c,e,h),L(c,t,h),L(c,n,h),L(c,s,h),L(c,f,h),L(c,v,h),L(c,r,h),L(c,u,h),d(u,$),L(c,p,h),L(c,w,h),L(c,y,h),d(y,q)},p(c,h){h&1&&l!==(l=new Date(c[0].request.expires_at*1e3)+"")&&H(t,l),h&1&&a!==(a=c[0].request.has_refresh_token?"yes":"no")&&H(f,a),h&1&&i!==(i=c[0].request.token_type+"")&&H($,i),h&1&&M!==(M=JSON.stringify(c[0],null,2)+"")&&H(q,M)},d(c){c&&m(e),c&&m(t),c&&m(n),c&&m(s),c&&m(f),c&&m(v),c&&m(r),c&&m(u),c&&m(p),c&&m(w),c&&m(y)}}}function Ve(o){let e,l,t,n,s,a=o[0].id+"",f,v,r,u,i,$,p,w,y,M,q,c,h,W,re,X,ne,x=new Date(o[0].request.issued_at*1e3)+"",te,se,oe,J,Y,ae,de,T=o[1]&&$e(),N=o[3]&&be(o);y=new Be({props:{msg:o[2],passive:!0}}),h=new Pe({props:{client:o[0].client}});let j=o[0].request.scope.split(" "),b=[];for(let _=0;_<j.length;_+=1)b[_]=ke(ve(o,j,_));const De=_=>G(b[_],1,1,()=>{b[_]=null});return J=new Oe({props:{level:"debug",$$slots:{default:[Ue]},$$scope:{ctx:o}}}),{c(){e=k("section"),l=k("div"),t=k("h2"),n=D("Grant "),s=k("code"),f=D(a),v=U(),r=k("div"),T&&T.c(),u=U(),i=k("div"),$=k("input"),p=U(),N&&N.c(),w=U(),F(y.$$.fragment),M=U(),q=k("div"),c=D("To: "),F(h.$$.fragment),W=k("br"),re=D(`
		Scopes:
		`),X=k("ul");for(let _=0;_<b.length;_+=1)b[_].c();ne=D(`
		Issued at: `),te=D(x),se=k("br"),oe=U(),F(J.$$.fragment),this.h()},l(_){e=E(_,"SECTION",{class:!0});var g=C(e);l=E(g,"DIV",{class:!0});var S=C(l);t=E(S,"H2",{class:!0});var Z=C(t);n=I(Z,"Grant "),s=E(Z,"CODE",{});var ee=C(s);f=I(ee,a),ee.forEach(m),Z.forEach(m),v=V(S),r=E(S,"DIV",{class:!0});var B=C(r);T&&T.l(B),B.forEach(m),u=V(S),i=E(S,"DIV",{class:!0});var P=C(i);$=E(P,"INPUT",{class:!0,type:!0}),p=V(P),N&&N.l(P),w=V(P),K(y.$$.fragment,P),P.forEach(m),S.forEach(m),M=V(g),q=E(g,"DIV",{class:!0});var A=C(q);c=I(A,"To: "),K(h.$$.fragment,A),W=E(A,"BR",{}),re=I(A,`
		Scopes:
		`),X=E(A,"UL",{});var he=C(X);for(let ie=0;ie<b.length;ie+=1)b[ie].l(he);he.forEach(m),ne=I(A,`
		Issued at: `),te=I(A,x),se=E(A,"BR",{}),oe=V(A),K(J.$$.fragment,A),A.forEach(m),g.forEach(m),this.h()},h(){R(t,"class","svelte-1b7sxv4"),R(r,"class","tags"),R($,"class","delete"),R($,"type","button"),$.value="Revoke (delete)",$.disabled=o[1],R(i,"class","action svelte-1b7sxv4"),R(l,"class","meta flex flex-row svelte-1b7sxv4"),R(q,"class","content"),R(e,"class","grant panel flex flex-column")},m(_,g){L(_,e,g),d(e,l),d(l,t),d(t,n),d(t,s),d(s,f),d(l,v),d(l,r),T&&T.m(r,null),d(l,u),d(l,i),d(i,$),d(i,p),N&&N.m(i,null),d(i,w),z(y,i,null),d(e,M),d(e,q),d(q,c),z(h,q,null),d(q,W),d(q,re),d(q,X);for(let S=0;S<b.length;S+=1)b[S].m(X,null);d(q,ne),d(q,te),d(q,se),d(q,oe),z(J,q,null),Y=!0,ae||(de=_e($,"click",o[4]),ae=!0)},p(_,[g]){(!Y||g&1)&&a!==(a=_[0].id+"")&&H(f,a),_[1]?T||(T=$e(),T.c(),T.m(r,null)):T&&(T.d(1),T=null),(!Y||g&2)&&($.disabled=_[1]),_[3]?N?N.p(_,g):(N=be(_),N.c(),N.m(i,w)):N&&(N.d(1),N=null);const S={};g&4&&(S.msg=_[2]),y.$set(S);const Z={};if(g&1&&(Z.client=_[0].client),h.$set(Z),g&1){j=_[0].request.scope.split(" ");let B;for(B=0;B<j.length;B+=1){const P=ve(_,j,B);b[B]?(b[B].p(P,g),O(b[B],1)):(b[B]=ke(P),b[B].c(),O(b[B],1),b[B].m(X,null))}for(me(),B=j.length;B<b.length;B+=1)De(B);pe()}(!Y||g&1)&&x!==(x=new Date(_[0].request.issued_at*1e3)+"")&&H(te,x);const ee={};g&513&&(ee.$$scope={dirty:g,ctx:_}),J.$set(ee)},i(_){if(!Y){O(y.$$.fragment,_),O(h.$$.fragment,_);for(let g=0;g<j.length;g+=1)O(b[g]);O(J.$$.fragment,_),Y=!0}},o(_){G(y.$$.fragment,_),G(h.$$.fragment,_),b=b.filter(Boolean);for(let g=0;g<b.length;g+=1)G(b[g]);G(J.$$.fragment,_),Y=!1},d(_){_&&m(e),T&&T.d(),N&&N.d(),Q(y),Q(h),we(b,_),Q(J),ae=!1,de()}}}function He(o,e,l){let t;qe(o,Ge,r=>l(3,t=r));const n=Ie();let{grant:s}=e,a=s.request.issued_at===s.request.expires_at,f;async function v(){try{await ye.grantsRevoke(s.id),l(1,a=!0),n("reload")}catch(r){l(2,f=r)}}return o.$$set=r=>{"grant"in r&&l(0,s=r.grant)},[s,a,f,t,v]}class Je extends fe{constructor(e){super();ue(this,e,He,Ve,ce,{grant:0})}}function Ee(o,e,l){const t=o.slice();return t[6]=e[l],t}function Ye(o){let e=o[4]("grants.count",{values:{count:o[0].length}})+"",l,t,n,s,a=o[0],f=[];for(let r=0;r<a.length;r+=1)f[r]=Le(Ee(o,a,r));const v=r=>G(f[r],1,1,()=>{f[r]=null});return{c(){l=D(e),t=U();for(let r=0;r<f.length;r+=1)f[r].c();n=ge()},l(r){l=I(r,e),t=V(r);for(let u=0;u<f.length;u+=1)f[u].l(r);n=ge()},m(r,u){L(r,l,u),L(r,t,u);for(let i=0;i<f.length;i+=1)f[i].m(r,u);L(r,n,u),s=!0},p(r,u){if((!s||u&17)&&e!==(e=r[4]("grants.count",{values:{count:r[0].length}})+"")&&H(l,e),u&33){a=r[0];let i;for(i=0;i<a.length;i+=1){const $=Ee(r,a,i);f[i]?(f[i].p($,u),O(f[i],1)):(f[i]=Le($),f[i].c(),O(f[i],1),f[i].m(n.parentNode,n))}for(me(),i=a.length;i<f.length;i+=1)v(i);pe()}},i(r){if(!s){for(let u=0;u<a.length;u+=1)O(f[u]);s=!0}},o(r){f=f.filter(Boolean);for(let u=0;u<f.length;u+=1)G(f[u]);s=!1},d(r){r&&m(l),r&&m(t),we(f,r),r&&m(n)}}}function je(o){let e,l;return e=new Be({props:{msg:o[1],passive:!0}}),{c(){F(e.$$.fragment)},l(t){K(e.$$.fragment,t)},m(t,n){z(e,t,n),l=!0},p(t,n){const s={};n&2&&(s.msg=t[1]),e.$set(s)},i(t){l||(O(e.$$.fragment,t),l=!0)},o(t){G(e.$$.fragment,t),l=!1},d(t){Q(e,t)}}}function Fe(o){let e,l;return e=new Ce({}),{c(){F(e.$$.fragment)},l(t){K(e.$$.fragment,t)},m(t,n){z(e,t,n),l=!0},p:le,i(t){l||(O(e.$$.fragment,t),l=!0)},o(t){G(e.$$.fragment,t),l=!1},d(t){Q(e,t)}}}function Le(o){let e,l;return e=new Je({props:{grant:o[6]}}),e.$on("reload",o[5]),{c(){F(e.$$.fragment)},l(t){K(e.$$.fragment,t)},m(t,n){z(e,t,n),l=!0},p(t,n){const s={};n&1&&(s.grant=t[6]),e.$set(s)},i(t){l||(O(e.$$.fragment,t),l=!0)},o(t){G(e.$$.fragment,t),l=!1},d(t){Q(e,t)}}}function Ke(o){let e,l,t,n,s,a,f,v,r;const u=[Fe,je,Ye],i=[];function $(p,w){return p[3]===p[2].Loading?0:p[3]===p[2].LoadingError?1:p[3]===p[2].Loaded?2:-1}return~(s=$(o))&&(a=i[s]=u[s](o)),{c(){e=k("main"),l=k("input"),n=U(),a&&a.c(),this.h()},l(p){e=E(p,"MAIN",{class:!0});var w=C(e);l=E(w,"INPUT",{type:!0}),n=V(w),a&&a.l(w),w.forEach(m),this.h()},h(){R(l,"type","button"),l.value="Reload",l.disabled=t=o[3]===o[2].Loading,R(e,"class","grants")},m(p,w){L(p,e,w),d(e,l),d(e,n),~s&&i[s].m(e,null),f=!0,v||(r=_e(l,"click",o[5]),v=!0)},p(p,[w]){(!f||w&12&&t!==(t=p[3]===p[2].Loading))&&(l.disabled=t);let y=s;s=$(p),s===y?~s&&i[s].p(p,w):(a&&(me(),G(i[y],1,1,()=>{i[y]=null}),pe()),~s?(a=i[s],a?a.p(p,w):(a=i[s]=u[s](p),a.c()),O(a,1),a.m(e,null)):a=null)},i(p){f||(O(a),f=!0)},o(p){G(a),f=!1},d(p){p&&m(e),~s&&i[s].d(),v=!1,r()}}}function ze(o,e,l){let t;qe(o,Te,r=>l(4,t=r));let n,s="";var a;(function(r){r[r.Loading=0]="Loading",r[r.LoadingError=1]="LoadingError",r[r.Loaded=2]="Loaded"})(a||(a={}));let f;Re(async()=>{await Ne(),await v()});async function v(){console.log("reload"),l(3,f=a.Loading);try{l(0,n=await ye.grantsList()),l(3,f=a.Loaded)}catch(r){l(1,s=r.message),l(3,f=a.LoadingError)}}return[n,s,a,f,t,v]}class st extends fe{constructor(e){super();ue(this,e,ze,Ke,ce,{})}}export{st as default};
